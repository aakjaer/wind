var PullToRefresh=function(){function a(a,b,c,d){var e=this;this.breakpoint=80,this.container=a,this.slidebox=b,this.slidebox_icon=c,this.handler=d,this._slidedown_height=0,this._anim=null,this._dragged_down=!1,this.hammertime=Hammer(this.container).on("touch dragdown release",function(a){e.handleHammer(a)})}return a.prototype.handleHammer=function(a){switch(a.type){case"touch":this.hide();break;case"release":if(!this._dragged_down)return;cancelAnimationFrame(this._anim),a.gesture.deltaY>=this.breakpoint?(this.container.removeClass().addClass("pullrefresh-loading"),this.slidebox_icon.removeClass().addClass("icon loading"),this.setHeight(60),this.handler.call(this)):(this.slidebox.removeClass().addClass("slideup"),this.container.removeClass(),this.hide());break;case"dragdown":var b=window.scrollY;if(b>5)return;0!==b&&window.scrollTo(0,0),this._dragged_down=!0,this._anim||this.updateHeight(),a.gesture.preventDefault(),this._slidedown_height=.4*a.gesture.deltaY}},a.prototype.setHeight=function(a){Modernizr.csstransforms3d?(this.container.css("transform","translate3d(0,"+a+"px,0)"),this.container.css("oTransform","translate3d(0,"+a+"px,0)"),this.container.css("msTransform","translate3d(0,"+a+"px,0)"),this.container.css("mozTransform","translate3d(0,"+a+"px,0)"),this.container.css("webkitTransform","translate3d(0,"+a+"px,0) scale3d(1,1,1)")):Modernizr.csstransforms?(this.container.css("transform","translate(0,"+a+"px)"),this.container.css("oTransform"," translate(0,"+a+"px)"),this.container.css("msTransform","translate(0,"+a+"px)"),this.container.css("mozTransform","translate(0,"+a+"px)"),this.container.css("webkitTransform","translate(0,"+a+"px)")):this.container.css("top",a+"px")},a.prototype.hide=function(){this.container.className="",this._slidedown_height=0,this.setHeight(0),cancelAnimationFrame(this._anim),this._anim=null,this._dragged_down=!1},a.prototype.slideUp=function(){var a=this;cancelAnimationFrame(this._anim),this.slidebox.removeClass().addClass("slideup"),this.container.removeClass().addClass("pullrefresh-slideup"),this.setHeight(0),setTimeout(function(){a.hide()},500)},a.prototype.updateHeight=function(){var a=this;this.setHeight(this._slidedown_height),this._slidedown_height>=this.breakpoint?(this.container.removeClass().addClass("pullrefresh-breakpoint"),this.slidebox_icon.removeClass().addClass("icon arrow arrow-up")):(this.container.removeClass(),this.slidebox_icon.removeClass().addClass("icon arrow")),this._anim=requestAnimationFrame(function(){a.updateHeight()})},a}();$(document).ready(function(){var a=$("#container"),b=$("#pullrefresh"),c=$("#pullrefresh-icon"),d=new PullToRefresh(a,b,c);d.handler=function(){var a=this;setTimeout(function(){a.slideUp(),console.log(WeatherApp)},1500)}}),function(){$(document).ready(function(){function a(a){this.initData=a,this.weatherStations=[]}function b(a,b){this.stationId=a,this.stationName=b,this.windSpeed=0,this.windAngle=0,this.temperature="",this.timestamp="",this.chartImageURL=e+this.stationId+f,this.DOMElement={}}var c="http://servlet.dmi.dk/bv/servlet/",d=c+"bv?stat=",e=c+"bvImage?stat=",f="&param=wind",g="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22"+encodeURIComponent(d),h=$("#weather-app .weather-stations"),i=$("#ws-template2").html();a.prototype={constructor:a,init:function(){var a=this;$.each(this.initData,function(c,d){var e=new b(d.id,d.name);e.renderWeatherStation(),a.weatherStations[c]=e,setTimeout(function(){e.getDOMElement().addClass("animated fadeIn")},100*(c+1)),e.loadWeatherData()})},refreshAll:function(){console.log(this.weatherStations)}},b.prototype={constructor:b,whoAmI:function(){console.log("I am: "+this.stationName)},loadWeatherData:function(){var a,b,c=this;this.setState("loading"),a=g+this.stationId+"%22&format=xml&callback=?",$.jsonp({url:a,success:function(a){a.results[0]&&(b=c.filterData(a.results[0]),c.setWeatherData(b),c.fillWeatherData())},error:function(){c.setState("error")}})},getDOMElement:function(){return this.DOMElement},filterData:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return a=a.replace(/<?\/body[^>]*>/g,""),a=a.replace(/[\r|\n]+/g,""),a=a.replace(/<--[\S\s]*?-->/g,""),a=a.replace(/<noscript[^>]*>[\S\s]*?<\/noscript>/g,""),a=a.replace(/<script[^>]*>[\S\s]*?<\/script>/g,""),a=a.replace(/<script.*\/>/,""),a=a.replace(/<img.*\/>/,""),b=".*?",c="((?:(?:[0-1][0-9])|(?:[2][0-3])|(?:[0-9])):(?:[0-5][0-9])(?::[0-5][0-9])?(?:\\s?(?:am|AM|pm|PM))?)",d=".*?",e="(\\d+)",f=".*?",g="([+-]?\\d*\\.\\d+)(?![-+0-9\\.])",h=".*?",i="([+-]?\\d*\\.\\d+)(?![-+0-9\\.])",j=new RegExp(b+c+d+e+f+g+h+i,["i"]),k=j.exec(a),null!==k?(l=k[1].replace(/</,"&lt;"),m=k[2].replace(/</,"&lt;"),n=k[3].replace(/</,"&lt;"),o=k[4].replace(/</,"&lt;"),p={windSpeed:n,windAngle:m,temperature:o,timestamp:l}):void 0},setWeatherData:function(a){this.windSpeed=a.windSpeed,this.windAngle=a.windAngle,this.temperature=a.temperature,this.timestamp=a.timestamp},fillWeatherData:function(){var a=this.DOMElement.find(".station-wind-direction"),b=this;this.DOMElement.find(".station-wind-speed b").html(this.windSpeed),this.DOMElement.find(".station-timestamp").html(this.timestamp),this.DOMElement.find(".station-timestamp").html(this.timestamp),this.DOMElement.find(".station-temperature").html(this.temperature),this.DOMElement.find(".station-chart img").attr("src",this.chartImageURL),setTimeout(function(){b.setWindDirection(a,b.windAngle)},300),this.setState("done")},setWindDirection:function(a,b){$(a[0]).css("-moz-transform","rotate("+b+"deg)"),$(a[0]).css("-webkit-transform","rotate("+b+"deg)"),$(a[0]).css("-ms-transform","rotate("+b+"deg)"),$(a[0]).css("-o-transform","rotate("+b+"deg)")},setState:function(a){this.DOMElement.attr("data-state",a)},renderWeatherStation:function(){var a;Mustache.parse(i),a=Mustache.render(i,this),h.append(a),this.DOMElement=h.find('[data-station-id="'+this.stationId+'"]')}},yepnope({load:["/scripts/vendor/pull-to-refresh.js"],callback:{"pull-to-refresh":function(){console.log("pull stuff loaded!")}}});var j=[{name:"Drogden",id:"6183"},{name:"Kbh lufthavn",id:"6180"},{name:"Gniben",id:"6169"},{name:"Jægerspris",id:"56"},{name:"Nakkehoved Fyr",id:"6168"},{name:"Kraneled",id:"1350"},{name:"Vindebæk Kyst",id:"6147"},{name:"Langø",id:"6138"},{name:"Thorsminde",id:"6052"}],k=new a(j);k.init()})}();